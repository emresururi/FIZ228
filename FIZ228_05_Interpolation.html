
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Interpolation &#8212; FIZ228 - Numerical Analysis Lecture Notes</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Minimization &amp; Optimization" href="FIZ228_06_MinimizeOptimize.html" />
    <link rel="prev" title="Regression" href="FIZ228_04_Regression.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">FIZ228 - Numerical Analysis Lecture Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Cover.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ228_01_DataProcesses.html">
   Importing, parsing, processing and exporting datasets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ228_02_DataVisualization.html">
   Visualization of datasets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ228_03_LeastSquaresErrors.html">
   Least Squares Method &amp; Error Estimations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ228_04_Regression.html">
   Regression
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Interpolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ228_06_MinimizeOptimize.html">
   Minimization &amp; Optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ228_07_ClusteringAndClassification.html">
   Clustering and Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ228_08_OrdinaryDifferentialEquations.html">
   Ordinary Differential Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ228_Exercises_01.html">
   Exercise Set #1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ228_Exercises_02.html">
   Exercise Set #2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ228_TakeHomeExam_01.html">
   Take-Home Exam #1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ228_TakeHomeExam_02.html">
   Take-Home Exam #2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FIZ228_TakeHomeExam_03.html">
   Take-Home Exam #3
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/FIZ228_05_Interpolation.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/FIZ228_05_Interpolation.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/emresururi/FIZ228/HEAD/v2/gh/emresururi/FIZ228/main?urlpath=tree/FIZ228_05_Interpolation.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Interpolation
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#polynomial-interpolation">
     Polynomial Interpolation
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#polyfit-poly1d-polyval-and-poly-roots">
     Polyfit, poly1d, polyval and poly + roots
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dearest-dear-linear-algebra-3">
     Dearest dear linear algebra! &lt;3
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#newton-interpolating-polynomials">
   Newton Interpolating Polynomials
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example">
     Example:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#increasing-the-order">
     Increasing the order
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Example
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lagrange-interpolating-polynomials">
   Lagrange Interpolating Polynomials
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Example
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Example
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#via-the-builtin-scipy-interpolate-lagrange-function">
       via the builtin scipy.interpolate.lagrange() function
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inverse-interpolation">
   Inverse Interpolation
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonus-finite-difference-method">
   Bonus: Finite Difference Method
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-chapra-2012">
     Example (Chapra, 2012)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Interpolation</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Interpolation
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#polynomial-interpolation">
     Polynomial Interpolation
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#polyfit-poly1d-polyval-and-poly-roots">
     Polyfit, poly1d, polyval and poly + roots
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dearest-dear-linear-algebra-3">
     Dearest dear linear algebra! &lt;3
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#newton-interpolating-polynomials">
   Newton Interpolating Polynomials
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example">
     Example:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#increasing-the-order">
     Increasing the order
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Example
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lagrange-interpolating-polynomials">
   Lagrange Interpolating Polynomials
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Example
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Example
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#via-the-builtin-scipy-interpolate-lagrange-function">
       via the builtin scipy.interpolate.lagrange() function
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inverse-interpolation">
   Inverse Interpolation
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonus-finite-difference-method">
   Bonus: Finite Difference Method
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-chapra-2012">
     Example (Chapra, 2012)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="interpolation">
<h1>Interpolation<a class="headerlink" href="#interpolation" title="Permalink to this headline">¶</a></h1>
<p><strong>FIZ228 - Numerical Analysis</strong><br />
Dr. Emre S. Tasci, Hacettepe University</p>
<p>In our “Regression” lecture, we talked about fitting a function/model/curve that passes <em>as close as possible</em> to a given set of data points. But sometimes we find ourselves in a case where we have clearly defined points and would like to know about the behaviour between these points. This method of estimating the intermediate values while retaining the known values is known as <em>interpolation</em>.</p>
<p>The given data points act as the <em>boundary conditions</em>, usually fixed and thus very suitable for interpolation applcations. We are given a partial look on the system which corresponds to the <em>initial conditions</em>.</p>
<p>As was the case in regression, there is always a risk of <em>overfitting</em> alas in the interpolation, we <strong>must</strong> hit all the given data (within an error tolerance that is related to the measurements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<section id="polynomial-interpolation">
<h2>Polynomial Interpolation<a class="headerlink" href="#polynomial-interpolation" title="Permalink to this headline">¶</a></h2>
<p>Revisiting our discussion in regression, we can <em>always</em> fit a set of <span class="math notranslate nohighlight">\(n\)</span> data points using a polynomial of <span class="math notranslate nohighlight">\((n-1)\)</span>th order:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(i\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(x_i\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(y_i\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>10</p></td>
<td><p>25</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>20</p></td>
<td><p>70</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>30</p></td>
<td><p>380</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>40</p></td>
<td><p>550</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>50</p></td>
<td><p>610</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>60</p></td>
<td><p>1220</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>70</p></td>
<td><p>830</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>80</p></td>
<td><p>1450</p></td>
</tr>
</tbody>
</table>
</section>
<section id="polyfit-poly1d-polyval-and-poly-roots">
<h2>Polyfit, poly1d, polyval and poly + roots<a class="headerlink" href="#polyfit-poly1d-polyval-and-poly-roots" title="Permalink to this headline">¶</a></h2>
<p>We can use numpy’s built in polynomial functions to fit (<code class="docutils literal notranslate"><span class="pre">polyfit</span></code>), evaluate (<code class="docutils literal notranslate"><span class="pre">poly1d</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">polyval</span></code>) and even construct polynomials from roots (<code class="docutils literal notranslate"><span class="pre">poly</span></code>) or <em>vice versa</em> (<code class="docutils literal notranslate"><span class="pre">roots</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">10</span><span class="p">),[</span><span class="mi">25</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">380</span><span class="p">,</span><span class="mi">550</span><span class="p">,</span><span class="mi">610</span><span class="p">,</span><span class="mi">1220</span><span class="p">,</span><span class="mi">830</span><span class="p">,</span><span class="mi">1450</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">yy</span> <span class="o">+=</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">xx</span><span class="o">**</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<span class="c1"># we could as well had used poly1d function</span>
<span class="c1"># to functionalize the polynomial 8)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="c1"># another alternative is to use polyval:</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="s2">&quot;-b&quot;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s2">&quot;ok&quot;</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">f</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span><span class="s2">&quot;-r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 2.31051587e-07 -6.89097222e-05  8.34131944e-03 -5.27253472e-01
  1.86274861e+01 -3.63810556e+02  3.60735714e+03 -1.37900000e+04]
----------------------------------------------------------------------
           7             6            5          4         3         2
2.311e-07 x - 6.891e-05 x + 0.008341 x - 0.5273 x + 18.63 x - 363.8 x + 3607 x - 1.379e+04
[  25.           70.          380.          550.          610.
 1220.          830.         1449.99999999]
[  25.           70.          380.          550.          610.
 1220.          830.         1449.99999999]
</pre></div>
</div>
<img alt="_images/FIZ228_05_Interpolation_5_1.png" src="_images/FIZ228_05_Interpolation_5_1.png" />
</div>
</div>
<p>A 7th degree polynomial might be too much for our taste! 8) So let’s begin with something simpler. For example, what would be the polynomial whose roots are -1 and 2?..</p>
<p>Since it has two roots, it must be a second order polynomial (<em>quadratic</em>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 1. -1. -2.]
</pre></div>
</div>
</div>
</div>
<p>To write it more neatly, we can construct a poly object using the coefficients:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   2
1 x - 1 x - 2
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[x^2-x-2\]</div>
<p>ladies and gents!</p>
<p>Let’s go from reverse and find the roots of a given polynomial via <code class="docutils literal notranslate"><span class="pre">roots</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">qq</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 2. -1.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># feeding the coefficients would also work:</span>
<span class="n">x12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 2. -1.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">qq</span><span class="p">,</span><span class="n">xx</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="s2">&quot;-r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/FIZ228_05_Interpolation_13_0.png" src="_images/FIZ228_05_Interpolation_13_0.png" />
</div>
</div>
</section>
<section id="dearest-dear-linear-algebra-3">
<h2>Dearest dear linear algebra! &lt;3<a class="headerlink" href="#dearest-dear-linear-algebra-3" title="Permalink to this headline">¶</a></h2>
<p>Now, let’s take 3 points from our designated polynomial, and afterwards forget about the actual polynomial:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">qq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">qc</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">3.1</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">4.3</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">qq</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">qq</span><span class="p">,</span><span class="n">xx</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s2">&quot;ko&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-3.1  14.71]
 [ 0.7   1.79]
 [ 4.3  16.19]]
</pre></div>
</div>
<img alt="_images/FIZ228_05_Interpolation_15_1.png" src="_images/FIZ228_05_Interpolation_15_1.png" />
</div>
</div>
<p>This is the part where we forget our polynomial information:</p>
<div class="math notranslate nohighlight">
\[Q(x) = 1x^2-1x+2\]</div>
<p>and thus, we are left with the data points to ponder on:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>x</p></th>
<th class="head"><p>-3.1</p></th>
<th class="head"><p>0.7</p></th>
<th class="head"><p>4.3</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>y</p></td>
<td><p>14.71</p></td>
<td><p>1.79</p></td>
<td><p>16.19</p></td>
</tr>
</tbody>
</table>
<p>We have 3 data-points, so we’ll assume a 2nd order polynomial in the form:</p>
<div class="math notranslate nohighlight">
\[Q(x) = q_1 x^2 + q_2 x^1 + q_3 x^0\]</div>
<p>and we have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}Q(-3.1) = q_1 (-3.1)^2+q_2 (-3.1)+q_3 = 14.71\\
Q(0.7) = q_1 (0.7)^2+q_2 (0.7)+q_3 = 1.79\\
Q(4.3) = q_1 (4.3)^2+q_2 (4.3)+q_3 = 16.19
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">3.1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">4.3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 9.61  0.49 18.49]
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}Q(-3.1) = 9.61q_1-3.1 q_2+q_3 = 14.71\\
Q(0.7) = 0.49 q1+0.7q_2+q_3 = 1.79\\
Q(4.3) = 18.49 q_1+4.3 q_2+q_3 = 16.19
\end{split}\]</div>
<p>so, it is actually nothing but 3 equations with 3 unknowns! We know how to solve it! 8)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix}
9.61 &amp; -3.1 &amp; 1\\
0.49&amp;0.7&amp;1\\
18.49&amp;4.3&amp;1
\end{pmatrix}
\begin{pmatrix}q_1\\q_2\\q_3\end{pmatrix}
=
\begin{pmatrix}14.71\\1.79\\16.19\end{pmatrix}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">9.61</span><span class="p">,</span><span class="o">-</span><span class="mf">3.1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mf">0.49</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mf">18.49</span><span class="p">,</span><span class="mf">4.3</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">14.71</span><span class="p">,</span><span class="mf">1.79</span><span class="p">,</span><span class="mf">16.19</span><span class="p">])</span>
<span class="n">q123</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">q123</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 1. -1.  2.]
</pre></div>
</div>
</div>
</div>
<p>… ta-taaaa!</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="newton-interpolating-polynomials">
<h1>Newton Interpolating Polynomials<a class="headerlink" href="#newton-interpolating-polynomials" title="Permalink to this headline">¶</a></h1>
<p>Newton polynomials incorporate known (given) points to go for the next one. For example, if two points are known, we pass a line through them and using similarity, we evaluate the value at the specified point.</p>
<p>Suppose we have <span class="math notranslate nohighlight">\(x_1,f(x_1)\)</span>, <span class="math notranslate nohighlight">\(x_2,f(x_2)\)</span> and we want to evaluate it at <span class="math notranslate nohighlight">\(x\)</span>. We haven’t been given the actual function so the situation is something like this:</p>
<p><img alt="05_NewtonInterpolation_Chapra" src="_images/05_NewtonInterpolation_Chapra.png" /></p>
<p>(don’t forget that we don’t know / can’t see the real function but only know about the two data points <span class="math notranslate nohighlight">\((x_1,x_2)\)</span>)</p>
<p>So, we’ll reach <span class="math notranslate nohighlight">\(f(x)\)</span> via similarity – going through the definition of the slope, we have:</p>
<div class="math notranslate nohighlight">
\[\frac{f_1(x)-f(x_1)}{x-x_1} = \frac{f(x_2)-f(x_1)}{x_2-x_1}\]</div>
<p>singling out <span class="math notranslate nohighlight">\(f_1(x)\)</span>, we get:</p>
<div class="math notranslate nohighlight">
\[\boxed{f_1(x)=f(x_1)+\frac{f(x_2)-f(x_1)}{x_2-x_1} (x-x_1)}\]</div>
<p><em>The indice “1” in <span class="math notranslate nohighlight">\(f_1\)</span> denotes that this is a first-order (linear) interpolation.</em></p>
<section id="example">
<h2>Example:<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Estimate <span class="math notranslate nohighlight">\(\ln2\)</span> using:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\ln1 = 0\)</span> and <span class="math notranslate nohighlight">\(\ln6=1.791759\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\ln1 = 0\)</span> and <span class="math notranslate nohighlight">\(\ln4=1.386294\)</span></p></li>
</ol>
<p>(calculate the true percentage relative error (<span class="math notranslate nohighlight">\(\varepsilon_t\)</span>) using the true value of <span class="math notranslate nohighlight">\(\ln2 = 0.693147\)</span>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1</span>
<span class="n">ln1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">ln6</span> <span class="o">=</span> <span class="mf">1.791759</span>

<span class="n">ln2_1</span> <span class="o">=</span> <span class="n">ln1</span> <span class="o">+</span> <span class="p">(</span><span class="n">ln6</span><span class="o">-</span><span class="n">ln1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">6</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      ln2 ~ </span><span class="si">{:.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ln2_1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;True value: </span><span class="si">{:.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;       E_t: </span><span class="si">{:.2f}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">ln2_1</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      ln2 ~ 0.358352
True value: 0.693147
       E_t: 48.30%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2</span>
<span class="n">ln1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">ln4</span> <span class="o">=</span> <span class="mf">1.386294</span>

<span class="n">ln2_2</span> <span class="o">=</span> <span class="n">ln1</span> <span class="o">+</span> <span class="p">(</span><span class="n">ln4</span><span class="o">-</span><span class="n">ln1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      ln2 ~ </span><span class="si">{:.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ln2_2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;True value: </span><span class="si">{:.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;       E_t: </span><span class="si">{:.2f}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">ln2_2</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      ln2 ~ 0.462098
True value: 0.693147
       E_t: 33.33%
</pre></div>
</div>
</div>
</div>
</section>
<section id="increasing-the-order">
<h2>Increasing the order<a class="headerlink" href="#increasing-the-order" title="Permalink to this headline">¶</a></h2>
<p>Newton’s polynomials are represented in increasing order as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
f_1(x) &amp;= b_1 + b_2(x-x_1)\\
f_2(x) &amp;= b_1 + b_2(x-x_1)+b_3(x-x_1)(x-x_2)\\
f_3(x) &amp;= b_1 + b_2(x-x_1)+b_3(x-x_1)(x-x_2)+b_4(x-x_1)(x-x_2)(x-x_3)\\
&amp;\dots\end{align*}\end{split}\]</div>
<p>here, the <span class="math notranslate nohighlight">\(b\)</span> coefficients are derived using the previously calculated coefficients, starting from the 1st one we have calculated using similarity (i.e., <span class="math notranslate nohighlight">\(b_2 = \frac{f(x_2)-f(x_1)}{x_2-x_1}\)</span>). So actually, we use the previous one’s form to calculate the current:</p>
<div class="math notranslate nohighlight">
\[b_1 : f(x') \Rightarrow b_2 = \frac{f(x_2)-f(x_1)}{x_2-x_1}\]</div>
<div class="math notranslate nohighlight">
\[b_2 : \frac{f(x'')-f(x')}{x''-x'} \Rightarrow b_3 = \frac{\frac{f(x_3)-f(x_2)}{x_3-x_2}-\frac{f(x_2)-f(x_1)}{x_2-x_1}}{x_3 - x_1}\]</div>
<p>these coefficients are called as <em>divided differences</em>.</p>
<p>Here’s a scheme of how to proceed forward in calculating these divided differences:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{matrix}
   x_1 &amp; f(x_1) &amp;                                 &amp; \\
       &amp;        &amp; {f(x_2)-f(x_1)\over x_2 - x_1}  &amp; \\
   x_2 &amp; f(x_2) &amp;                                 &amp; {{f(x_3)-f(x_2)\over x_3 - x_2}-{f(x_2)-f(x_1)\over x_2 - x_1} \over x_3 - x_1} \\
       &amp;        &amp; {f(x_3)-f(x_2)\over x_3 - x_2}  &amp; \\
   x_3 &amp; f(x_3) &amp;                                 &amp; \vdots \\
       &amp;        &amp; \vdots                          &amp; \\
\vdots &amp;        &amp;                                 &amp; \vdots \\
       &amp;        &amp; \vdots                          &amp; \\
   x_n &amp; f(x_n) &amp;                                 &amp; \\
\end{matrix}\end{split}\]</div>
<p>Let’s put this into action in our next (evolved) example:</p>
<section id="id1">
<h3>Example<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Use the three of the previous given <span class="math notranslate nohighlight">\(\ln(x)\)</span> values to estimate <span class="math notranslate nohighlight">\(\ln2\)</span>.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_1 = 1,\;f(x_1) = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_2 = 4,\;f(x_2)=1.386294\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_3 = 6,\;f(x_3)=1.791759\)</span></p></li>
</ul>
<p>(calculate the true percentage relative error (<span class="math notranslate nohighlight">\(\varepsilon_t\)</span>) using the true value of <span class="math notranslate nohighlight">\(\ln2 = 0.693147\)</span>)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{matrix}
   x_1=1 &amp; b_1 = f(x_1)=0 &amp;                                 &amp; \\
       &amp;        &amp; b_2={f(x_2)-f(x_1)\over x_2 - x_1} = 0.462098&amp; \\
   x_2=4 &amp; f(x_2)= 1.386294&amp;                                 &amp; b_3={{f(x_3)-f(x_2)\over x_3 - x_2}-{f(x_2)-f(x_1)\over x_2 - x_1} \over x_3 - x_1}= -0.051873\\
       &amp;        &amp; {f(x_3)-f(x_2)\over x_3 - x_2} = 0.202733 &amp; \\
   x_3=6 &amp; f(x_3)=1.791759 &amp;                                 &amp;  
\end{matrix}\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">f_x1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">x2</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">f_x2</span> <span class="o">=</span> <span class="mf">1.386294</span>
<span class="n">x3</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">f_x3</span> <span class="o">=</span> <span class="mf">1.791759</span>

<span class="n">b1</span> <span class="o">=</span> <span class="n">f_x1</span>
<span class="n">b2</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_x2</span> <span class="o">-</span> <span class="n">f_x1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_x3</span> <span class="o">-</span> <span class="n">f_x2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span>

<span class="n">b3</span> <span class="o">=</span> <span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="n">b2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">f_x</span> <span class="o">=</span> <span class="n">f_x1</span> <span class="o">+</span> <span class="n">b2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="n">b3</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      ln2 ~ </span><span class="si">{:.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f_x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;True value: </span><span class="si">{:.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;       E_t: </span><span class="si">{:.2f}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">f_x</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      ln2 ~ 0.565844
True value: 0.693147
       E_t: 18.37%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting the given data, our estimation for x=2</span>
<span class="c1"># and the actual function:</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
<span class="n">yN</span> <span class="o">=</span> <span class="n">f_x1</span> <span class="o">+</span> <span class="n">b2</span><span class="o">*</span><span class="p">(</span><span class="n">xx</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="n">b3</span><span class="o">*</span><span class="p">(</span><span class="n">xx</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xx</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span>
<span class="n">data_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="p">,</span><span class="n">x</span><span class="p">])</span>
<span class="n">data_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f_x1</span><span class="p">,</span><span class="n">f_x2</span><span class="p">,</span><span class="n">f_x3</span><span class="p">,</span><span class="n">f_x</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yN</span><span class="p">,</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;mistyrose&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span><span class="n">data_y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span><span class="s2">&quot;ob&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">data_y</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="s2">&quot;or&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/FIZ228_05_Interpolation_29_0.png" src="_images/FIZ228_05_Interpolation_29_0.png" />
</div>
</div>
<p>The advantage of this method is its flexibility in the face of the addition of more data points. So suppose that we made another measurement at the <span class="math notranslate nohighlight">\(x_4=5\)</span> point and came up with <span class="math notranslate nohighlight">\(f(x_4)=1.609438\)</span> value and we want to incorporate this new data to better our fit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">f_x1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">x2</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">f_x2</span> <span class="o">=</span> <span class="mf">1.386294</span>
<span class="n">x3</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">f_x3</span> <span class="o">=</span> <span class="mf">1.791759</span>

<span class="n">b1</span> <span class="o">=</span> <span class="n">f_x1</span>
<span class="n">b2</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_x2</span> <span class="o">-</span> <span class="n">f_x1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_x3</span> <span class="o">-</span> <span class="n">f_x2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span>

<span class="n">b3</span> <span class="o">=</span> <span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="n">b2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span>

<span class="c1"># --- up to here, we had the same calculations,</span>
<span class="c1"># no need to recalculate them in actual run ---</span>

<span class="n">x4</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">f_x4</span> <span class="o">=</span> <span class="mf">1.609438</span>

<span class="c1"># we&#39;ll fill in the new coefficients:</span>
<span class="n">d2</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_x4</span> <span class="o">-</span> <span class="n">f_x3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">-</span><span class="n">x3</span><span class="p">)</span>
<span class="n">c3</span> <span class="o">=</span> <span class="p">(</span><span class="n">d2</span> <span class="o">-</span> <span class="n">c2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span>
<span class="n">b4</span> <span class="o">=</span> <span class="p">(</span><span class="n">c3</span> <span class="o">-</span> <span class="n">b3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span>

<span class="c1"># and we just append the b4 coefficient in our approximation:</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">f_x</span> <span class="o">=</span> <span class="n">f_x1</span> <span class="o">+</span> <span class="n">b2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="n">b3</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span>\
     <span class="o">+</span><span class="n">b4</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      ln2 ~ </span><span class="si">{:.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f_x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;True value: </span><span class="si">{:.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;       E_t: </span><span class="si">{:.2f}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">f_x</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      ln2 ~ 0.628767
True value: 0.693147
       E_t: 9.29%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting the given data, our estimation for x=2</span>
<span class="c1"># and the actual function:</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
<span class="n">yN</span> <span class="o">=</span> <span class="n">f_x1</span> <span class="o">+</span> <span class="n">b2</span><span class="o">*</span><span class="p">(</span><span class="n">xx</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="n">b3</span><span class="o">*</span><span class="p">(</span><span class="n">xx</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xx</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="n">b4</span><span class="o">*</span><span class="p">(</span><span class="n">xx</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xx</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xx</span><span class="o">-</span><span class="n">x3</span><span class="p">)</span>
<span class="n">data_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="p">,</span><span class="n">x4</span><span class="p">,</span><span class="n">x</span><span class="p">])</span>
<span class="n">data_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f_x1</span><span class="p">,</span><span class="n">f_x2</span><span class="p">,</span><span class="n">f_x3</span><span class="p">,</span><span class="n">f_x4</span><span class="p">,</span><span class="n">f_x</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yN</span><span class="p">,</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span><span class="n">data_y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span><span class="s2">&quot;ob&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_x</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">data_y</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="s2">&quot;or&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/FIZ228_05_Interpolation_32_0.png" src="_images/FIZ228_05_Interpolation_32_0.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="lagrange-interpolating-polynomials">
<h1>Lagrange Interpolating Polynomials<a class="headerlink" href="#lagrange-interpolating-polynomials" title="Permalink to this headline">¶</a></h1>
<p>Lagrange polynomials are yet another way to interpolate using the given data points where it uses the addition of the weighted data points.</p>
<p><img alt="05_LagrangeInterpolation_Chapra" src="_images/05_LagrangeInterpolation_Chapra.png" />
(Figure: Chapra, 2012)</p>
<p><strong>1st order Lagrange polynomial</strong> is given by:</p>
<div class="math notranslate nohighlight">
\[f_1(x) = L_1 f(x_1) + L_2 f(x_2)\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[ L_1 = \frac{x-x_2}{x_1 - x_2},\;L_2 = \frac{x-x_1}{x_2-x_1}\]</div>
<p>so:</p>
<div class="math notranslate nohighlight">
\[f_1(x) = \frac{x-x_2}{x_1 - x_2}f(x_1) + \frac{x-x_1}{x_2-x_1}f(x_2)\]</div>
<p><strong>2nd order Lagrange polynomial</strong> is given by:</p>
<div class="math notranslate nohighlight">
\[f_2(x) = L_1 f(x_1) + L_2 f(x_2)+L_3 f_(x_3)\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[ L_1 = \frac{(x-x_2)(x-x_3)}{(x_1 - x_2)(x_1 - x_3)},\;L_2 = \frac{(x-x_1)(x-x_3)}{(x_2 - x_1)(x_2 - x_3)},\;L_3 = \frac{(x-x_1)(x-x_2)}{(x_3 - x_1)(x_3 - x_2)}\]</div>
<p>so:</p>
<div class="math notranslate nohighlight">
\[f_2(x) = \frac{(x-x_2)(x-x_3)}{(x_1 - x_2)(x_1 - x_3)}f(x_1) + \frac{(x-x_1)(x-x_3)}{(x_2 - x_1)(x_2 - x_3)}f(x_2) + \frac{(x-x_1)(x-x_2)}{(x_3 - x_1)(x_3 - x_2)}f(x_3)\]</div>
<p>and in general:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f_{n-1}=\sum_{i=1}^{n}{L_i(x)f(x_i)},\quad L_i(x)=\prod_{j=1\\j\ne i}^{n}{\frac{x-x_j}{x_i-x_j}}\end{split}\]</div>
<section id="id2">
<h2>Example<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Use a Lagrange interpolating polynomial of the first and second order to evaluate the density of unused motor oil at <span class="math notranslate nohighlight">\(T=15^oC\)</span> based on the following data:</p>
<div class="math notranslate nohighlight">
\[\begin{split}x_1 = 0,\;f(x_1)=3.85\\
x_2 = 20,\;f(x_2) = 0.800\\
x_3 = 40,\;f(x_3) = 0.212\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">f_x1</span> <span class="o">=</span> <span class="mf">3.85</span>

<span class="n">x2</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">f_x2</span> <span class="o">=</span> <span class="mf">0.8</span>

<span class="n">x</span> <span class="o">=</span> <span class="mi">15</span>

<span class="n">f1_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="n">f_x1</span>\
      <span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="n">f_x2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1st order approximation: </span><span class="si">{:.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f1_x</span><span class="p">))</span>

<span class="n">x3</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">f_x3</span> <span class="o">=</span> <span class="mf">0.212</span>

<span class="n">f2_x</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x3</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x3</span><span class="p">))</span> <span class="o">*</span> <span class="n">f_x1</span>\
      <span class="o">+</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x3</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x3</span><span class="p">))</span> <span class="o">*</span> <span class="n">f_x2</span>\
      <span class="o">+</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x2</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="n">x3</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x3</span><span class="o">-</span><span class="n">x2</span><span class="p">))</span> <span class="o">*</span> <span class="n">f_x3</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2nd order approximation: </span><span class="si">{:.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f2_x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1st order approximation: 1.562500
2nd order approximation: 1.331687
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h2>Example<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>Use the given <span class="math notranslate nohighlight">\(\ln(x)\)</span> values to estimate <span class="math notranslate nohighlight">\(\ln2\)</span> via Lagrange polynomial.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_1 = 1,\;f(x_1) = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_2 = 4,\;f(x_2)=1.386294\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_3 = 6,\;f(x_3)=1.791759\)</span></p></li>
</ul>
<p>(calculate the true percentage relative error (<span class="math notranslate nohighlight">\(\varepsilon_t\)</span>) using the true value of <span class="math notranslate nohighlight">\(\ln2 = 0.693147\)</span>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">f_x1</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">x2</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">f_x2</span> <span class="o">=</span> <span class="mf">1.386294</span>

<span class="n">x3</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">f_x3</span> <span class="o">=</span> <span class="mf">1.791759</span>

<span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">f2_x</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x3</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="n">x1</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x3</span><span class="p">))</span> <span class="o">*</span> <span class="n">f_x1</span>\
      <span class="o">+</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x3</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x3</span><span class="p">))</span> <span class="o">*</span> <span class="n">f_x2</span>\
      <span class="o">+</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x2</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="n">x3</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x3</span><span class="o">-</span><span class="n">x2</span><span class="p">))</span> <span class="o">*</span> <span class="n">f_x3</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      ln2 ~ </span><span class="si">{:.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f2_x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;True value: </span><span class="si">{:.6f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;       E_t: </span><span class="si">{:.2f}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">f2_x</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      ln2 ~ 0.565844
True value: 0.693147
       E_t: 18.37%
</pre></div>
</div>
</div>
</div>
<section id="via-the-builtin-scipy-interpolate-lagrange-function">
<h3>via the builtin scipy.interpolate.lagrange() function<a class="headerlink" href="#via-the-builtin-scipy-interpolate-lagrange-function" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.lagrange.html">scipy.interpolate.lagrange()</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Using the built in implementation:</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">lagrange</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.386294</span><span class="p">,</span> <span class="mf">1.791759</span><span class="p">]</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">lagrange</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          2
-0.05187 x + 0.7215 x - 0.6696
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5658442
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="inverse-interpolation">
<h1>Inverse Interpolation<a class="headerlink" href="#inverse-interpolation" title="Permalink to this headline">¶</a></h1>
<p>Normally, we do interpolation to calculate <span class="math notranslate nohighlight">\(f(x)\)</span> for some <span class="math notranslate nohighlight">\(x\)</span> value that lies between given data points. However, sometimes, it might be necessary to find the <span class="math notranslate nohighlight">\(x\)</span> corresponding to a given <span class="math notranslate nohighlight">\(f(x)\)</span> value - this operation is called the <em>inverse interpolation</em>.</p>
<p>The first thing that comes to mind is to reinterpret <span class="math notranslate nohighlight">\(x\)</span> as <span class="math notranslate nohighlight">\(f(x)\)</span> and <span class="math notranslate nohighlight">\(f(x)\)</span> as <span class="math notranslate nohighlight">\(x\)</span>, then to proceed as a normal interpolation. This can have its own penalties. Consider <span class="math notranslate nohighlight">\(f(x) = 1/x\)</span> function. So for a number of observations from <span class="math notranslate nohighlight">\(x=1,\dots, 7\)</span>, we will have:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1.    2.    3.    4.    5.    6.    7.   ]
 [1.    0.5   0.333 0.25  0.2   0.167 0.143]]
</pre></div>
</div>
</div>
</div>
<p>now suppose that we want to find the value of <span class="math notranslate nohighlight">\(x\)</span> such that <span class="math notranslate nohighlight">\(f(x)=0.3\)</span>. Inverting <span class="math notranslate nohighlight">\(x\leftrightarrow f(x)\)</span> yields:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">]))</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">pol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1.    0.5   0.333 0.25  0.2   0.167 0.143]
 [1.    2.    3.    4.    5.    6.    7.   ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  5040. -13068.  13132.  -6769.   1960.   -322.     28.]
      6             5             4        3        2
5040 x - 1.307e+04 x + 1.313e+04 x - 6769 x + 1960 x - 322 x + 28
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.3251199999985914
</pre></div>
</div>
</div>
</div>
<p>… or, we can use our heads, as usual! ;)</p>
<p>What we lacked in the above approximation is we failed to <em>read</em> the data. The data, with the given (x,y) order was evenly spaced. Therefore we could have gone for a 2nd order fit around <span class="math notranslate nohighlight">\(x=\{2,3,4\}\)</span>. Focusing there:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pol2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pol2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         2
0.04167 x - 0.375 x + 1.083
</pre></div>
</div>
</div>
</div>
<p>We are looking at a value of <span class="math notranslate nohighlight">\(x\)</span> where the above equation becomes 0.3, in other words:</p>
<div class="math notranslate nohighlight">
\[0.3 = 0.04167 x^2 - 0.375 x + 1.083\]</div>
<p>and this is just a problem of finding the root!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">([</span><span class="mf">0.04167</span><span class="p">,</span><span class="o">-</span><span class="mf">0.375</span><span class="p">,</span><span class="mf">1.083</span><span class="o">-</span><span class="mf">0.3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[5.706 3.293]
</pre></div>
</div>
</div>
</div>
<p>Continuing to using our heads, we remember that, we were looking for the solutions between 2 and 4, hence we take 3.293 – considering that the true value being 3.333, we did a great job, by keeping to our human sides, not by being a number cruncher! 8)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="bonus-finite-difference-method">
<h1>Bonus: Finite Difference Method<a class="headerlink" href="#bonus-finite-difference-method" title="Permalink to this headline">¶</a></h1>
<p><em>(not quite interpolation but still… ;)</em></p>
<p>When we have a differential equation and the values at boundaries are known, we can interpolate via the finite differences method to approximate the derivatives as the slopes of the lines connecting the data points.</p>
<p>Suppose that we want to calculate the derivative of a function at the <span class="math notranslate nohighlight">\(x_i\)</span> point. We can take one of the two approaches to approximate the derivative:</p>
<p><img alt="05_FiniteDiff_1_Chapra.png" src="_images/05_FiniteDiff_1_Chapra.png" /> (Chapra, 2012)</p>
<p><strong>a) Forward Finite Difference Approximation</strong></p>
<p>Here, we have the slope as:</p>
<div class="math notranslate nohighlight">
\[\frac{\text{d}f(x)}{\text{d}x}\biggr\vert_{x_i} \approx \frac{f(x_{i+1})-f(x_{i})}{h}\]</div>
<p><strong>b) Backward Finite Difference Approximation</strong></p>
<p>Considering the backward we can also write the slope as:</p>
<div class="math notranslate nohighlight">
\[\frac{\text{d}f(x)}{\text{d}x}\biggr\vert_{x_i} \approx \frac{f(x_{i})-f(x_{i-1})}{h}\]</div>
<p>but the best of the both worlds would be to take both into account:</p>
<p><strong>Centered Finite Difference Approximation</strong>
<img alt="05_FiniteDiff_2_Chapra.png" src="_images/05_FiniteDiff_2_Chapra.png" /> (Chapra, 2012)</p>
<div class="math notranslate nohighlight">
\[\frac{\text{d}f(x)}{\text{d}x}\biggr\vert_{x_i} \approx \frac{f(x_{i+1})-f(x_{i-1})}{2h}\]</div>
<section id="example-chapra-2012">
<h2>Example (Chapra, 2012)<a class="headerlink" href="#example-chapra-2012" title="Permalink to this headline">¶</a></h2>
<p><img alt="05_TemperatureDiffusion_Chapra.png" src="_images/05_TemperatureDiffusion_Chapra.png" /></p>
<p>The figure shows a long, thin rod positioned between two walls that are held at constant temperatures. Heat flows through the rod as well as between the rod and the surrounding air. For the steady-state case, a differential equation based on heat conservation can be written for such a system as:</p>
<div class="math notranslate nohighlight">
\[\frac{\text{d}^2T}{\text{d}x^2}-h'(T_a - T) = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(T\)</span> is the temperature (<span class="math notranslate nohighlight">\(^oC\)</span>), <span class="math notranslate nohighlight">\(x\)</span> is the distance along the rod (m), <span class="math notranslate nohighlight">\(h'\)</span> is the heat transfer coefficient between the rod and the surrounding air (<span class="math notranslate nohighlight">\(m^{-2}\)</span>) and <span class="math notranslate nohighlight">\(T_a\)</span> is the air temperature (<span class="math notranslate nohighlight">\(^oC\)</span>).</p>
<p>Given <span class="math notranslate nohighlight">\(h'=0.01m^{-2}\)</span>, <span class="math notranslate nohighlight">\(T_a = 20^oC\)</span>, <span class="math notranslate nohighlight">\(T(x=0) = 40^oC\)</span> and <span class="math notranslate nohighlight">\(T(x=10\,m) = 200^oC\)</span>, calculate the temperature at the marked points in between.</p>
<p><strong>Solution</strong></p>
<p>If we approximate the 2nd order derivative with the finite difference method, we will have for each of the marked points (<span class="math notranslate nohighlight">\(T_i,\;i={1,2,3,4}\)</span> – <span class="math notranslate nohighlight">\(T_0\)</span> and <span class="math notranslate nohighlight">\(T_5\)</span> are given and <span class="math notranslate nohighlight">\(\Delta x = 2\,m\)</span>):</p>
<div class="math notranslate nohighlight">
\[\frac{\text{d}^2T}{\text{d}x^2}\biggr\vert_{i}\approx \frac{T_{i+1}-2T_{i}+T_{i-1}}{\Delta x^2}\]</div>
<p>and the main differential equation takes the form of:</p>
<div class="math notranslate nohighlight">
\[\frac{T_{i+1}-2T_{i}+T_{i-1}}{\Delta x^2}+h'(T_a - T_i)=0\]</div>
<p>Expanding and re-arranging yields:</p>
<div class="math notranslate nohighlight">
\[-T_{i-1}+(2+\Delta x^2 h')T_i-T_{i+1} = \Delta x^2 h' T_a\]</div>
<p>substituting the values of <span class="math notranslate nohighlight">\(\Delta x = 2\,m\)</span>, <span class="math notranslate nohighlight">\(T_a = 20^oC\)</span> and <span class="math notranslate nohighlight">\(h'  =0.01 m^{-2}\)</span>:</p>
<div class="math notranslate nohighlight">
\[-T_{i-1}+2.04 T_i-T_{i+1} = 0.8\]</div>
<p>Writing explicitly for each of the points, we have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
-T_0 + 2.04T_1-T_2&amp;=0.8\\
-T_1 + 2.04T_2-T_3&amp;=0.8\\
-T_2 + 2.04T_3-T_4&amp;=0.8\\
-T_3 + 2.04T_4-T_5&amp;=0.8
\end{align*}\end{split}\]</div>
<p>We already have <span class="math notranslate nohighlight">\(T_0\)</span> and <span class="math notranslate nohighlight">\(T_5\)</span> values:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
2.04T_1-T_2&amp;=40.8\\
-T_1 + 2.04T_2-T_3&amp;=0.8\\
-T_2 + 2.04T_3-T_4&amp;=0.8\\
-T_3 + 2.04T_4&amp;=200.8
\end{align*}\end{split}\]</div>
<p>This is nothing but a linear equation set! So all of a sudden our 2nd order ODE has transformed into a set of 4 linear equations with 4 unknowns!</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}2.04 &amp; -1 &amp; 0 &amp; 0\\
-1 &amp; 2.04 &amp; -1 &amp; 0 \\
0 &amp;-1 &amp; 2.04 &amp; -1 \\
0 &amp; 0 &amp; -1 &amp; 2.04 
\end{bmatrix}
\begin{bmatrix} T_1\\T_2\\T_3\\T_4\end{bmatrix}=\begin{bmatrix} 40.8\\0.8\\0.8\\200.8\end{bmatrix}\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mf">2.04</span><span class="p">,</span><span class="mf">2.04</span><span class="p">,</span><span class="mf">2.04</span><span class="p">,</span><span class="mf">2.04</span><span class="p">])</span>
<span class="n">A2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
<span class="n">A3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">A1</span><span class="o">+</span><span class="n">A2</span><span class="o">+</span><span class="n">A3</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 2.04 -1.    0.    0.  ]
 [-1.    2.04 -1.    0.  ]
 [ 0.   -1.    2.04 -1.  ]
 [ 0.    0.   -1.    2.04]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">40.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">200.8</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 40.8   0.8   0.8 200.8]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 65.97   93.778 124.538 159.48 ]
</pre></div>
</div>
</div>
</div>
<p>Btw, the analytical solution of the given ODE is:</p>
<div class="math notranslate nohighlight">
\[T(X) = 73.4523e^{0.1x}-53.4523e^{-0.1x}+20\]</div>
<p>Let’s check how good did we do:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fT</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">73.4523</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mf">53.4523</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">TT</span> <span class="o">=</span> <span class="n">fT</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">TT</span><span class="p">,</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">T</span><span class="p">,</span><span class="s2">&quot;ro&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">],[</span><span class="mi">40</span><span class="p">,</span><span class="mi">200</span><span class="p">],</span><span class="s2">&quot;ko&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/FIZ228_05_Interpolation_58_0.png" src="_images/FIZ228_05_Interpolation_58_0.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Heavily benefitted from Chapra’s “Applied Numerical Methods with MATLAB for Engineers and Scientists” (2012) along with dear Dr. Eda Çelik Akdur’s “KMU 231 - Numerical Analysis” lecture notes.</p></li>
<li><p>The divided differences scheme’s <span class="math notranslate nohighlight">\(\LaTeX\)</span> code was adapted from the corresponding <a class="reference external" href="https://en.wikipedia.org/w/index.php?title=Newton_polynomial&amp;oldid=994324116#Examples">Wikipedia entry</a>.</p></li>
</ul>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="FIZ228_04_Regression.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Regression</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="FIZ228_06_MinimizeOptimize.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Minimization &amp; Optimization</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Emre S. Tasci, Ph.D.<br/>
    
        &copy; Copyright 2023.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>